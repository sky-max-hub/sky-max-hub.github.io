<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Title -->
<title>Docker概述和安装 - Hexo</title>

<!-- Icon -->
<link rel="icon" href="/favicon.ico">

<!-- Fonts -->
<link rel="preload" href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital@0;1&family=Open+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap" as="style" onload="this.onload=null, this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital@0;1&family=Open+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap"></noscript>


    <!-- KaTeX -->
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" as="style" onload="this.onload=null, this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"></noscript>


<!-- Style -->

<link rel="stylesheet" href="/styles/main.css">

<!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-theme-pure@1.0.1/dist/main.css"> -->



    <meta name="generator" content="Hexo 5.4.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
</head>
    <body>
        <div class="main gt-bg-theme-color-first">
            <div class="main-content">
                <nav class="navbar navbar-expand-lg">
    <div class="navbar-brand">
        <img class="user-avatar" src="/favicon.png" alt="头像">
        <div class="site-name gt-c-content-color-first">
            
        </div>
    </div>
    <button aria-label="Navbar Toggler" class="navbar-toggler" type="button" id="changeNavbar">
        <i class="gt-c-content-color-first" style="font-size: 18px;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" height="18px" fill="currentColor">
                <path d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z" />
            </svg>
        </i>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <div class="navbar-nav mr-auto" style="text-align: center; ">
            
                <div class="nav-item">
                    <a href="/" class="menu gt-a-link" target="_self">首页</a>
                </div>
            
                <div class="nav-item">
                    <a href="/archives/" class="menu gt-a-link" target="_self">归档</a>
                </div>
            
                <div class="nav-item">
                    <a href="/tags/" class="menu gt-a-link" target="_self">标签</a>
                </div>
            
                <div class="nav-item">
                    <a href="/friends/" class="menu gt-a-link" target="_self">友链</a>
                </div>
            
        </div>
    </div>
</nav>

<script>
    /* 移动端导航栏展开/收起切换 */
    document.getElementById('changeNavbar').onclick = function() {
        let element = document.getElementById('navbarSupportedContent');
        if (element.style.display === 'none' || element.style.display === '') {
            element.style.display = 'block';
        } else { 
            element.style.display = 'none';
        }
    }
</script>
                <div class="post-container">
    <div class="post-detail gt-bg-theme-color-second gt-c-content-color-first">
        <article class="gt-post-content">
            <h1 class="post-title">Docker概述和安装</h1>
            <div class="post-info">
                <time class="post-time gt-c-content-color-first">
                    · 2021-05-04 ·</time>
                
                    
                        <a href="/tags/Docker/" class="post-tag">
                            #Docker</a>
                    
                        <a href="/tags/Linux/" class="post-tag">
                            #Linux</a>
                    
                
            </div>
            <hr>
            <div class="post-content gt-c-content-color-first">
                <h2 id="Docker概述">Docker概述</h2>
<h3 id="Docker出现的原因">Docker出现的原因</h3>
<p>一款产品有两个环境：开发（开发环境）和上线（运维环境）。</p>
<p>环境配置和切换过于麻烦，每一台机器都要部署环境（集群Redis,ES,Hadoop），费时费力。</p>
<p>解决思路：发布一个项目<code>（jar+(redis+mysql+jdk+es)）</code>的同时能不能都带上环境安装打包？</p>
<p>传统思路：开发项目，运维部署项目和环境配置。</p>
<p>现在：开发打包部署上线，一套流程做完。</p>
<p><code>Docker为以上问题，提出了解决方案！</code></p>
<p><img src="https://img.sky123.top/img/image-20210422110559011.png" alt="image-20210422110559011"></p>
<p>Docker的思想来自于集装箱：通过特殊的隔离机制，将服务器利用到机制。</p>
<h3 id="Docker历史">Docker历史</h3>
<blockquote>
<p>1.Docker诞生于2013年</p>
</blockquote>
<blockquote>
<p>2.Docker &amp; LXC：Docker的第一个执行环境：LXC；但从0.9版本开始被Libcontainer取代</p>
</blockquote>
<blockquote>
<p>3.Docker &amp; Libcontainer：Libcontainer为Docker封装了Linux提供的基础功能，如cgroups，namespaces，netlink和netfilter等</p>
</blockquote>
<blockquote>
<p>4.Docker &amp; RunC： 2015年，Docker发布了RunC，一个轻量级的跨平台的容器运行；可以直接利用Libcontainer运行容器</p>
</blockquote>
<blockquote>
<p>5.Docker &amp; OCI（The Open Containers Initiative）: OCI是一个轻量级的开放式管理架构，由Docker，CoreOS和容器行业的其他领导厂商2015年建立，维护一些项目，制定容器运行的规范等</p>
</blockquote>
<blockquote>
<p>6.Docker &amp; Containerd： 2016年，Docker分拆了Containerd，并将其捐献给了社区；使得Docker将容器的管理功能移出Docker的核心引擎并移入了一个单独的守护进程（containerd）</p>
</blockquote>
<p>在容器技术出来以前，都是使用虚拟机技术，相比于虚拟机几个G,几分钟的启动时间，Docker做到了几个M甚至几KB的容量和秒级开启时间，这主要得益于它并不像虚拟机虚拟出操作系统或者内核，而是只保留了最核心的环境，十分的小巧。<code>所有的程序员都必须要会docker!</code></p>
<h3 id="Docker介绍">Docker介绍</h3>
<p><code>Docker是基于GO语言开发的开源项目！！</code></p>
<p>官网：<a target="_blank" rel="noopener" href="https://www.docker.com/">https://www.docker.com/</a></p>
<p>文档地址：<a target="_blank" rel="noopener" href="https://docs.docker.com/">https://docs.docker.com/</a></p>
<p>仓库地址：<a target="_blank" rel="noopener" href="https://hub.docker.com/">https://hub.docker.com/</a></p>
<p><img src="https://img.sky123.top/img/image-20210422111746659.png" alt="image-20210422111746659"></p>
<h3 id="Docker与虚拟机的比较">Docker与虚拟机的比较</h3>
<p>虚拟机技术缺点：启动慢，占用资源多，冗余步骤多</p>
<img src="https://img.sky123.top/img/image-20210422115546688.png" alt="image-20210422115546688" style="zoom:50%;">
<p>Docker容器化技术：不是模拟出一个完整的操作系统。</p>
<img src="https://img.sky123.top/img/image-20210422115733382.png" alt="image-20210422115733382" style="zoom:50%;">
<p>总结：</p>
<ol>
<li>传统虚拟机：虚拟出一系列硬件，运行一个完整的操作系统，然后在这个系统安装和运行软件</li>
<li>容器内的应用直接运行在宿主机上，容器没有自己的内核，也没有虚拟出硬件，所以十分轻便</li>
<li>每个容器是相互隔离的，每个容器都有一个属于自己的文件系统，互不影响。</li>
</ol>
<h3 id="Docker作用">Docker作用</h3>
<p>可以实现了 <code>DevOps(开发，运维)</code></p>
<ol>
<li>应用更快速的交付和部署：打包镜像发布测试，一键运行</li>
<li>更便捷的升级和扩缩容：使用了Docker，部署应用就像搭积木一个，项目打包为一个镜像，方便扩展</li>
<li>更简单的系统运维：在容器化之后，开发和测试环境都是高度一致的。</li>
<li>更高效的计算资源利用：Docker是内核级别的虚拟化，可以在一个物理机上运行多个容器实例，容器的性能可以被压榨到极致。</li>
</ol>
<h2 id="Docker基本组成">Docker基本组成</h2>
<h3 id="架构图">架构图</h3>
<p><img src="https://img.sky123.top/img/image-20210221182251636.png" alt="image-20210221182251636"></p>
<h3 id="基本概念">基本概念</h3>
<ol>
<li>
<p>镜像<code>（image）</code>：docker镜像好比是一个模板，可以通过这个模板创建容器服务，tomcat镜像===》run==》tomcat01容器，通过镜像可以创建多个容器（最终服务运行或项目运行就是在容器中的）</p>
</li>
<li>
<p>容器<code>（container）</code>：docker利用容器技术，独立地运行一个或一组应用，通过<code>image</code>来创建。</p>
<p>启动，停止，删除，基本命令</p>
<p>目前就可以将容器理解为一个简单的Linux系统</p>
</li>
<li>
<p>仓库<code>（repository）</code>：仓库是存放镜像的地方。有公有和私有仓库之分。</p>
<p>Docker Hub(默认是国外的)，阿里云。。。都有容器服务器（配置镜像加速）</p>
</li>
</ol>
<h2 id="Docker安装">Docker安装</h2>
<h3 id="环境准备：">环境准备：</h3>
<ol>
<li>Linux基础</li>
<li>Linux操作系统</li>
<li>使用 Xshell 连接远程服务器</li>
</ol>
<h3 id="查看环境：">查看环境：</h3>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">系统内核是3.10以上的</span>
[root@izwz91mv6i3x6k12jjqh60z ~]# uname -r
3.10.0-514.26.2.el7.x86_64

<span class="hljs-meta">#</span><span class="bash">查看系统信息</span>
[root@izwz91mv6i3x6k12jjqh60z ~]# cat /etc/os-release
NAME="CentOS Linux"
VERSION="7 (Core)"
ID="centos"
ID_LIKE="rhel fedora"
VERSION_ID="7"
PRETTY_NAME="CentOS Linux 7 (Core)"
ANSI_COLOR="0;31"
CPE_NAME="cpe:/o:centos:centos:7"
HOME_URL="https://www.centos.org/"
BUG_REPORT_URL="https://bugs.centos.org/"

CENTOS_MANTISBT_PROJECT="CentOS-7"
CENTOS_MANTISBT_PROJECT_VERSION="7"
REDHAT_SUPPORT_PRODUCT="centos"
REDHAT_SUPPORT_PRODUCT_VERSION="7"
</code></pre>
<h3 id="安装教程：">安装教程：</h3>
<p>可以查看官网文档：<a target="_blank" rel="noopener" href="https://docs.docker.com/engine/install/">https://docs.docker.com/engine/install/</a></p>
<p><img src="https://img.sky123.top/img/image-20210423220917139.png" alt="image-20210423220917139"></p>
<p>对于 <code>CentOS</code> 系统：</p>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">先卸载旧版本Docker系统（如果有的话）</span>
[root@izwz91mv6i3x6k12jjqh60z ~]# sudo yum remove docker \
                   docker-client \
                   docker-client-latest \
                   docker-common \
                   docker-latest \
                   docker-latest-logrotate \
                   docker-logrotate \
                   docker-engine
                   
Loaded plugins: fastestmirror
No Match for argument: docker
No Match for argument: docker-client
No Match for argument: docker-client-latest
No Match for argument: docker-common
No Match for argument: docker-latest
No Match for argument: docker-latest-logrotate
No Match for argument: docker-logrotate
No Match for argument: docker-engine
No Packages marked for removal


<span class="hljs-meta">#</span><span class="bash">安装需要的安装包</span>
[root@izwz91mv6i3x6k12jjqh60z ~]# yum install -y yum-utils

Installed:
  yum-utils.noarch 0:1.1.31-54.el7_8                                                                                                           

Dependency Installed:
  libxml2-python.x86_64 0:2.9.1-6.el7.5           python-chardet.noarch 0:2.2.1-3.el7           python-kitchen.noarch 0:1.1.1-5.el7          

Dependency Updated:
  libxml2.x86_64 0:2.9.1-6.el7.5                                                                                                               

Complete!

<span class="hljs-meta">#</span><span class="bash">配置下载Docker镜像</span>
sudo yum-config-manager \
    --add-repo \
    https://download.docker.com/linux/centos/docker-ce.repo

Loaded plugins: fastestmirror
adding repo from: https://download.docker.com/linux/centos/docker-ce.repo
grabbing file https://download.docker.com/linux/centos/docker-ce.repo to /etc/yum.repos.d/docker-ce.repo
repo saved to /etc/yum.repos.d/docker-ce.repo

<span class="hljs-meta">#</span><span class="bash">安装docker，一路输入确定安装即可</span>
sudo yum install docker-ce docker-ce-cli containerd.io


Dependency Installed:
  audit-libs-python.x86_64 0:2.8.5-4.el7                                  checkpolicy.x86_64 0:2.5-8.el7                                       
  container-selinux.noarch 2:2.119.2-1.911c772.el7_8                      docker-ce-rootless-extras.x86_64 0:20.10.6-3.el7                     
  docker-scan-plugin.x86_64 0:0.7.0-3.el7                                 fuse-overlayfs.x86_64 0:0.7.2-6.el7_8                                
  fuse3-libs.x86_64 0:3.6.1-4.el7                                         libcgroup.x86_64 0:0.41-21.el7                                       
  libseccomp.x86_64 0:2.3.1-4.el7                                         libsemanage-python.x86_64 0:2.5-14.el7                               
  policycoreutils-python.x86_64 0:2.5-34.el7                              python-IPy.noarch 0:0.75-6.el7                                       
  setools-libs.x86_64 0:3.3.8-4.el7                                       slirp4netns.x86_64 0:0.4.3-4.el7_8                                   

Dependency Updated:
  audit.x86_64 0:2.8.5-4.el7                             audit-libs.x86_64 0:2.8.5-4.el7         libselinux.x86_64 0:2.5-15.el7               
  libselinux-python.x86_64 0:2.5-15.el7                  libselinux-utils.x86_64 0:2.5-15.el7    libsemanage.x86_64 0:2.5-14.el7              
  libsepol.x86_64 0:2.5-10.el7                           policycoreutils.x86_64 0:2.5-34.el7     selinux-policy.noarch 0:3.13.1-268.el7_9.2   
  selinux-policy-targeted.noarch 0:3.13.1-268.el7_9.2   

Complete!

</code></pre>
<h3 id="启动测试：">启动测试：</h3>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">查看 docker 是否安装成功，和版本</span>

[root@izwz91mv6i3x6k12jjqh60z ~]# docker -v

Docker version 20.10.6, build 370c289

<span class="hljs-meta">#</span><span class="bash">启动 docker</span>
[root@izwz91mv6i3x6k12jjqh60z ~]# systemctl start docker

<span class="hljs-meta">#</span><span class="bash">运行测试</span>
[root@izwz91mv6i3x6k12jjqh60z ~]# docker run hello-world

Unable to find image 'hello-world:latest' locally
latest: Pulling from library/hello-world
b8dfde127a29: Pull complete 
Digest: sha256:f2266cbfc127c960fd30e76b7c792dc23b588c0db76233517e1891a4e357d519
Status: Downloaded newer image for hello-world:latest

Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
    (amd64)
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
<span class="hljs-meta"> $</span><span class="bash"> docker run -it ubuntu bash</span>

Share images, automate workflows, and more with a free Docker ID:
 https://hub.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/get-started/

<span class="hljs-meta">#</span><span class="bash">查看下载的 hello-world 镜像</span>
[root@izwz91mv6i3x6k12jjqh60z ~]# docker images
REPOSITORY    TAG       IMAGE ID       CREATED       SIZE
hello-world   latest    d1165f221234   7 weeks ago   13.3kB

</code></pre>
<h3 id="卸载Docker：">卸载Docker：</h3>
<pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">卸载</span>
yum remove docker-ce docker-ce-cli containerd.io

<span class="hljs-meta">#</span><span class="bash">删除文件</span>  
rm -rf /var/lib/docker

<span class="hljs-meta">#</span><span class="bash">/var/lib/docker  是docker的默认工作路径</span></code></pre>
<h2 id="Docker配置阿里云镜像仓库地址">Docker配置阿里云镜像仓库地址</h2>
<p>参考教程：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/allenjing/p/12575972.html">https://www.cnblogs.com/allenjing/p/12575972.html</a></p>
<p>登陆阿里云，找到如下选项：</p>
<p><img src="https://img.sky123.top/img/image-20210428092132408.png" alt="image-20210428092132408"></p>
<p><img src="https://img.sky123.top/img/image-20210428092924853.png" alt="image-20210428092924853"></p>
<pre><code class="hljs shell">sudo mkdir -p /etc/docker

sudo tee /etc/docker/daemon.json &lt;&lt;-'EOF'
{
  "registry-mirrors": ["https://bjyjzfeq.mirror.aliyuncs.com"]
}
EOF

sudo systemctl daemon-reload

sudo systemctl restart docker</code></pre>
<h2 id="Docker原理">Docker原理</h2>
<h3 id="helloworld的运行流程：">helloworld的运行流程：</h3>
<p><img src="https://img.sky123.top/img/image-20210428121216893.png" alt="image-20210428121216893"></p>
<p><img src="https://img.sky123.top/img/image-20210428121520142.png" alt="image-20210428121520142"></p>
<h3 id="底层原理：">底层原理：</h3>
<p>Docker工作原理：Docker是一个 <code>CS结构</code> 的系统，Docker 的守护进程运行在主机上，通过 Socket从客户端访问。</p>
<p>DockerServer 接收到 DokcerClient 的指令，就会执行这个命令。</p>
<p><img src="https://img.sky123.top/img/image-20210428122527218.png" alt="image-20210428122527218"></p>
<h3 id="Docker为什么比VM快？">Docker为什么比VM快？</h3>
<ol>
<li>Docker 有着比虚拟机更少的抽象层</li>
<li>Docker 利用的是宿主机的内核，而 VM 需要的是 <code>Guest OS</code>。</li>
<li>新建一个容器时，Docker 不需要像虚拟机一样重新加载一个操作系统的内核。</li>
</ol>
<p><img src="https://img.sky123.top/img/image-20210428122751694.png" alt="image-20210428122751694"></p>
<p><img src="https://img.sky123.top/img/image-20210428123110597.png" alt="image-20210428123110597"></p>

            </div>
        </article>
    </div>
    <br>
    
        <div class="next-prev-post">
            
                <div class="prev-post">
                    <div class="prev gt-c-content-color-first">
                        上一篇：<a href="/2021/05/04/docker/Docker03%E9%83%A8%E7%BD%B2%E7%BB%83%E4%B9%A0/" 
                            class="post-title gt-a-link">Docker部署练习</a>
                    </div>
                </div>
            
            
                <div class="next-post">
                    <div class="next gt-c-content-color-first">
                        下一篇：<a href="/2021/04/22/javascript/mock/" 
                            class="post-title gt-a-link">Mock和Mock.js</a>
                    </div>
                </div>
            
        </div>
    
    
</div>
                <div class="site-footer gt-c-content-color-first">
    <div class="footer-main">
        <!-- 建议保留版权信息或者添加主题信息到友链，感谢您的理解 -->
        <!-- 文件位置：layout/_includes/footer.ejs -->
        <span style="text-align: right; float: right;">Theme <a 
            href="https://github.com/renbaoshuo/hexo-theme-pure" target="_blank">Pure</a> | Powered by <a 
            href="https://hexo.io" target="_blank">Hexo</a></span>
        <span style="text-align: left;">Footer HTML
</span>
    </div>
</div>

            </div>
        </div>
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>