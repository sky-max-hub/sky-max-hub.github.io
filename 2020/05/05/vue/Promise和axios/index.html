<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="大白小怪兽">
    
    <title>
        
            vue学习笔记07-Promise和axios |
        
        大白小怪兽
    </title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="shortcut icon" href="/images/blog.png">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.1/source/css/font-awesome.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"blog.sky123.top","root":"/","language":"zh-CN","path":"search.xml"};
    KEEP.theme_config = {"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true},"style":{"primary_color":"#0066CC","avatar":"/images/avatar.jpg","favicon":"/images/blog.png","article_img_align":"left","left_side_width":"240px","content_max_width":"940px","hover":{"shadow":false,"scale":true},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":"乐于有所得，苦于无知"},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":true}}},"local_search":{"enable":true,"trigger":"auto","unescape":false,"preload":true},"code_copy":{"enable":true,"style":"mac"},"pjax":{"enable":true},"lazyload":{"enable":true},"version":"3.4.1"};
    KEEP.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 月前","year":"%s 年前"};
  </script>
<meta name="generator" content="Hexo 5.4.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
</head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fas fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            <a class="logo-title" href="/">
                大白小怪兽
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                首页
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                归档
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                标签
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                关于
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">首页</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">归档</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">标签</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">关于</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">vue学习笔记07-Promise和axios</span>
        </div>

        
            <div class="article-header">
<!--                <div class="avatar">-->
                    
<!--                </div>-->
                <div class="info">
<!--                    <div class="author">-->
<!--                        <span class="name"></span>-->
<!--                        -->
<!--                            <span class="author-label"></span>-->
<!--                        -->
<!--                    </div>-->
                    <div class="meta-info">
                        <div class="article-meta-info">
    <!--日期-->
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;2020-05-05
    </span>

    <!--字数统计-->
    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>3k 字</span>
        </span>
    

    <!--阅读时长-->
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>11 分钟</span>
        </span>
    

    <!--阅读人数-->
    

    <!--分类-->
    

    <!--标签-->
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/%E5%89%8D%E7%AB%AF/">前端</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/vue/">vue</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <h1>vue学习笔记07-Promise和axios</h1>
<hr>
<p><img lazyload="" src="/images/loading.svg" data-src="https://img.sky123.top/img/forest-166733_1280.jpg" alt=""></p>
<hr>
<h1>Promise</h1>
<h2 id="什么是Promise">什么是Promise?</h2>
<p>ES6中一个非常重要和好用的特性就是Promise。但是初次接触Promise会一脸懵逼，这TM是什么东西？</p>
<p>看看官方或者一些文章对它的介绍和用法，也是一头雾水。</p>
<p><code>Promise到底是做什么的呢？Promise是异步编程的一种解决方案。</code></p>
<p>那什么时候我们会来处理异步事件呢？一种很常见的场景应该就是网络请求了。</p>
<p><code>我们封装一个网络请求的函数，因为不能立即拿到结果，所以不能像简单的3+4=7一样将结果返回。</code></p>
<p><code>所以往往我们会传入另外一个函数，在数据请求成功时，将数据通过传入的函数回调出去。</code></p>
<p>如果只是一个简单的网络请求，那么这种方案不会给我们带来很大的麻烦。但是，当网络请求非常复杂时，就会出现回调地狱。</p>
<h3 id="网络请求的回调地狱">网络请求的回调地狱</h3>
<p>我们来考虑下面的场景(有夸张的成分)：<br>
我们需要通过一个url1从服务器加载一个数据data1，data1中包含了下一个请求的url2<br>
我们需要通过data1取出url2，从服务器加载数据data2，data2中包含了下一个请求的url3<br>
我们需要通过data2取出url3，从服务器加载数据data3，data3中包含了下一个请求的url4<br>
发送网络请求url4，获取最终的数据data4</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://img.sky123.top/img/image-20201001180021363.png" alt="image-20201001180021363"></p>
<p>上面的代码有什么问题吗？</p>
<p>正常情况下，不会有什么问题，可以正常运行并且获取我们想要的结果。<br>
<code>但是，这样额代码难看而且不容易维护。我们更加期望的是一种更加优雅的方式来进行这种异步操作。</code></p>
<p>如何做呢？就是使用Promise。Promise可以以一种非常优雅的方式来解决这个问题。</p>
<h2 id="Promise的使用">Promise的使用</h2>
<h3 id="定时器的异步事件">定时器的异步事件</h3>
<p>我们先来看看Promise最基本的语法。这里，我们用一个定时器来模拟异步事件：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://img.sky123.top/img/image-20201001180144293.png" alt="image-20201001180144293"></p>
<p>假设下面的data是从网络上1秒后请求的数据console.log就是我们的处理方式。</p>
<p>这是我们过去的处理方式，我们将它换成Promise代码</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://img.sky123.top/img/image-20201001180150141.png" alt="image-20201001180150141"></p>
<p>这个例子会让我们感觉脱裤放屁，多此一举</p>
<p>首先，下面的Promise代码明显比上面的代码看起来还要复杂。<br>
其次，下面的Promise代码中包含的resolve、reject、then、catch都是些什么东西？</p>
<p>我们先不管第一个复杂度的问题，因为这样的一个屁大点的程序根本看不出来Promise真正的作用。</p>
<h3 id="定时器异步事件解析">定时器异步事件解析</h3>
<p>我们先来认认真真的读一读这个程序到底做了什么？new Promise很明显是创建一个Promise对象</p>
<p>小括号中((resolve, reject) =&gt; {})也很明显就是一个函数，而且我们这里用的是之前刚刚学习过的箭头函数。<br>
但是resolve, reject它们是什么呢？</p>
<p>我们先知道一个事实：<code>在创建Promise时，传入的这个箭头函数是固定的（一般我们都会这样写）</code></p>
<p>resolve和reject它们两个也是函数，通常情况下，我们会根据请求数据的成功和失败来决定调用哪一个。<br>
成功还是失败？</p>
<p>如果是成功的，那么通常我们会调用resolve(messsage)，这个时候，我们后续的then会被回调。<br>
如果是失败的，那么通常我们会调用reject(error)，这个时候，我们后续的catch会被回调。</p>
<p>OK，这就是Promise最基本的使用了。</p>
<h3 id="Promise三种状态">Promise三种状态</h3>
<p>首先, 当我们开发中有异步操作时, 就可以给异步操作包装一个Promise<br>
异步操作之后会有三种状态我们一起来看一下这三种状态:</p>
<p>pending：等待状态，比如正在进行网络请求，或者定时器没有到时间。</p>
<p>fulfill：满足状态，当我们主动回调了resolve时，就处于该状态，并且会回调.then()</p>
<p>reject：拒绝状态，当我们主动回调了reject时，就处于该状态，并且会回调.catch()</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://img.sky123.top/img/image-20201001180314041.png" alt="image-20201001180314041"></p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://img.sky123.top/img/image-20201001180320624.png" alt="image-20201001180320624"></p>
<h2 id="Promise链式调用">Promise链式调用</h2>
<p>我们在看Promise的流程图时，发现无论是then还是catch都可以返回一个Promise对象。<br>
所以，我们的代码其实是可以进行链式调用的：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://img.sky123.top/img/image-20201001180432443.png" alt="image-20201001180432443"></p>
<p>这里我们直接通过Promise包装了一下新的数据，将Promise对象返回了<br>
Promise.resovle()：将数据包装成Promise对象，并且在内部回调resolve()函数<br>
Promise.reject()：将数据包装成Promise对象，并且在内部回调reject()函数</p>
<h3 id="链式调用简写">链式调用简写</h3>
<p>简化版代码：<br>
如果我们希望数据直接包装成Promise.resolve，那么在then中可以直接返回数据<br>
注意下面的代码中，我讲return Promise.resovle(data)改成了return data<br>
结果依然是一样的</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://img.sky123.top/img/image-20201001180530409.png" alt="image-20201001180530409"></p>
<h1>网络模块封装</h1>
<ul>
<li>常见的网络请求模块，以及优缺点对比。</li>
<li>JSONP的原理和封装
<ul>
<li>JSONP原理回顾</li>
<li>JSONP请求封装</li>
</ul>
</li>
<li>axios的内容详解
<ul>
<li>认识axios网络模块</li>
<li>发送基本请求</li>
<li>axios创建实例</li>
<li>axios拦截器的使用</li>
</ul>
</li>
</ul>
<h2 id="选择什么网络模块">选择什么网络模块?</h2>
<p>Vue中发送网络请求有非常多的方式, 那么, 在开发中, 如何选择呢?</p>
<p>选择一: 传统的Ajax是基于XMLHttpRequest(XHR)。为什么不用它呢?</p>
<p>非常好解释, 配置和调用方式等非常混乱。编码起来看起来就非常蛋疼。</p>
<p>所以真实开发中很少直接使用, 而是使用jQuery-Ajax</p>
<p>选择二: 在前面的学习中, 我们经常会使用jQuery-Ajax。相对于传统的Ajax非常好用.</p>
<p>为什么不选择它呢?首先, 我们先明确一点: 在Vue的整个开发中都是不需要使用jQuery了.</p>
<p>那么, 就意味着为了方便我们进行一个网络请求, 特意引用一个jQuery, 你觉得合理吗?<br>
jQuery的代码1w+行.<br>
Vue的代码才1w+行.</p>
<p>完全没有必要为了用网络请求就引用这个重量级的框架.</p>
<p>选择三: 官方在Vue1.x的时候, 推出了Vue-resource。Vue-resource的体积相对于jQuery小很多。另外Vue-resource是官方推出的.为什么不选择它呢?</p>
<p>在Vue2.0退出后, Vue作者就在GitHub的Issues中说明了去掉vue-resource, 并且以后也不会再更新.</p>
<p>那么意味着以后vue-reource不再支持新的版本时, 也不会再继续更新和维护.</p>
<p>对以后的项目开发和维护都存在很大的隐患.</p>
<p><code>选择四: 在说明不再继续更新和维护vue-resource的同时, 作者还推荐了一个框架: axios为什么用它呢?</code></p>
<p><code>axios有非常多的优点, 并且用起来也非常方便.</code></p>
<h2 id="jsonp">jsonp</h2>
<p>在前端开发中, 我们一种常见的网络请求方式就是JSONP。使用JSONP最主要的原因往往是为了解决跨域访问的问题.</p>
<p>JSONP的原理是什么呢?</p>
<p>JSONP的核心在于通过<code>&lt;script&gt;</code>标签的src来帮助我们请求数据.</p>
<p>原因是我们的项目部署在<code>domain1.com</code>服务器上时, 是不能直接访问<code>domain2.com</code>服务器上的资料的.</p>
<p>这个时候, 我们利用<code>&lt;script&gt;</code>标签的src帮助我们去服务器请求到数据, 将数据当做一个javascript的函数来执行, 并且执行</p>
<p>的过程中传入我们需要的json.<br>
所以, 封装jsonp的核心就在于我们监听window上的jsonp进行回调时的名称.<br>
JSONP如何封装呢?<br>
我们一起自己来封装一个处理JSONP的代码吧.</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://img.sky123.top/img/image-20201001181211558.png" alt="image-20201001181211558"></p>
<h3 id="JSONP封装">JSONP封装</h3>
<p><img lazyload="" src="/images/loading.svg" data-src="https://img.sky123.top/img/image-20201001181303298.png" alt="image-20201001181303298"></p>
<h2 id="为什么选择axios">为什么选择axios?</h2>
<p>作者推荐和功能特点</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://img.sky123.top/img/image-20201001181347060.png" alt="image-20201001181347060"></p>
<p>功能特点:</p>
<p>在浏览器中发送 XMLHttpRequests 请求</p>
<p>在 node.js 中发送 http请求</p>
<p>支持 Promise API</p>
<p>拦截请求和响应</p>
<p>转换请求和响应数据</p>
<p><code>补充: axios名称的由来? 个人理解。没有具体的翻译。axios: ajax i/o system.</code></p>
<h3 id="axiox请求方式">axiox请求方式</h3>
<p>支持多种请求方式:</p>
<p>axios(config)</p>
<p>axios.request(config)</p>
<p>axios.get(url[, config])</p>
<p>axios.delete(url[, config])</p>
<p>axios.head(url[, config])</p>
<p>axios.post(url[, data[, config]])</p>
<p>axios.put(url[, data[, config]])</p>
<p>axios.patch(url[, data[, config]])</p>
<h4 id="发送get请求演示">发送get请求演示</h4>
<p><img lazyload="" src="/images/loading.svg" data-src="https://img.sky123.top/img/image-20201001181523520.png" alt="image-20201001181523520"></p>
<h4 id="发送并发请求">发送并发请求</h4>
<p>有时候, 我们可能需求同时发送两个请求。使用axios.all, 可以放入多个请求的数组.</p>
<p>axios.all([]) 返回的结果是一个数组，使用 axios.spread 可将数组 [res1,res2] 展开为 res1, res2</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://img.sky123.top/img/image-20201001181609571.png" alt="image-20201001181609571"></p>
<p>在上面的示例中, 我们的BaseURL是固定的。事实上, 在开发中可能很多参数都是固定的。这个时候我们可以进行一些抽取, 也可以利用axiox的全局配置</p>
<pre><code class="highlight js">axios.defaults.baseURL = ‘<span class="number">123.207</span><span class="number">.32</span><span class="number">.32</span>:<span class="number">8000</span>’
axios.defaults.headers.post[‘Content-Type’] = ‘application/x-www-form-urlencoded’;</code></pre>
<p><img lazyload="" src="/images/loading.svg" data-src="https://img.sky123.top/img/image-20201001181716339.png" alt="image-20201001181716339"></p>
<h3 id="常见的配置选项">常见的配置选项</h3>
<p>请求地址：url: ‘/user’	请求类型：method: ‘get’,</p>
<p>请根路径：baseURL: ‘<a class="link" target="_blank" rel="noopener" href="http://www.mt.com/api">http://www.mt.com/api<i class="fas fa-external-link-alt"></i></a>’	请求前的数据处理：transformRequest:[function(data){}],</p>
<p>请求后的数据处理：transformResponse: [function(data){}],</p>
<p>自定义的请求头：headers:{‘x-Requested-With’:‘XMLHttpRequest’},</p>
<p>URL查询对象：params:{ id: 12 }	查询对象序列化函数：paramsSerializer: function(params){ }</p>
<p>request body：data: { key: ‘aa’},</p>
<p>超时设置s：timeout: 1000,</p>
<p>跨域是否带Token：withCredentials: false,</p>
<p>自定义请求处理：adapter: function(resolve, reject, config){},</p>
<p>身份验证信息：auth: { uname: ‘’, pwd: ‘12’},</p>
<p>响应的数据格式 json / blob /document /arraybuffer / text / stream：responseType: ‘json’,</p>
<h3 id="axios的实例">axios的实例</h3>
<p>为什么要创建axios的实例呢?当我们从axios模块中导入对象时, 使用的实例是默认的实例.</p>
<p>当给该实例设置一些默认配置时, 这些配置就被固定下来了。但是后续开发中, 某些配置可能会不太一样.</p>
<p>比如某些请求需要使用特定的baseURL或者timeout或者content-Type等。这个时候, 我们就可以创建新的实例, 并且传入属于该实例的配置信息.</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://img.sky123.top/img/image-20201001182018472.png" alt="image-20201001182018472"></p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://img.sky123.top/img/image-20201001182031415.png" alt="image-20201001182031415"></p>
<h3 id="拦截器">拦截器</h3>
<p>axios提供了拦截器，用于我们在发送每次请求或者得到相应后，进行对应的处理。如何使用拦截器呢？</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://img.sky123.top/img/image-20201001182111819.png" alt="image-20201001182111819"></p>
<p>请求拦截可以做到的事情：</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://img.sky123.top/img/image-20201001182137248.png" alt="image-20201001182137248"></p>
<p>请求拦截中错误拦截较少，通常都是配置相关的拦截。可能的错误比如请求超时，可以将页面跳转到一个错误页面中。</p>
<p>响应拦截中完成的事情：</p>
<p>响应的成功拦截中，主要是对数据进行过滤。</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://img.sky123.top/img/image-20201001182210645.png" alt="image-20201001182210645"></p>
<p>响应的失败拦截中，可以根据status判断报错的错误码，跳转到不同的错误提示页面。</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://img.sky123.top/img/image-20201001182214712.png" alt="image-20201001182214712"></p>
<h2 id="项目开发中的网络模块使用">项目开发中的网络模块使用</h2>
<p>目录结构</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://img.sky123.top/img/image-20201001182916556.png" alt="image-20201001182916556"></p>
<p>在 request.js 中封装网络请求模块</p>
<pre><code class="highlight js"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span>
<span class="keyword">import</span> QS <span class="keyword">from</span> <span class="string">'qs'</span>
<span class="comment">//import Cookie from 'js-cookie'</span>

<span class="keyword">const</span> res = {
    code: <span class="number">0</span>,
    msg: <span class="string">"请求异常"</span>,
    data: {}
}

<span class="keyword">export</span> <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">request</span>(<span class="params">url, data, type</span>) </span>{
    <span class="keyword">try</span> {
        <span class="comment">//自动给请求加上token和collegeId，因为mock原因暂时注释掉</span>
        <span class="comment">// try {</span>
        <span class="comment">//     // 获取登录数据</span>
        <span class="comment">//     if (Cookie.get('token') !== undefined) {</span>
        <span class="comment">//         const token = JSON.parse(Cookie.get('token'))</span>
        <span class="comment">//         console.log('token信息',token)</span>
        <span class="comment">//         if (data !== undefined &amp;&amp; data !== null ) {</span>
        <span class="comment">//             data.token = token.token</span>
        <span class="comment">//             data.collegeId = token.collegeId</span>
        <span class="comment">//         } else {</span>
        <span class="comment">//             data = {</span>
        <span class="comment">//                 token: token.token,</span>
        <span class="comment">//                 collegeId: token.collegeId</span>
        <span class="comment">//             }</span>
        <span class="comment">//         }</span>
        <span class="comment">//     }</span>
        <span class="comment">// } catch (e) {</span>
        <span class="comment">//     //</span>
        <span class="comment">// }</span>
        <span class="comment">// 判断请求类型</span>
        <span class="keyword">if</span> (type === <span class="string">'get'</span>) {
            <span class="keyword">return</span> (<span class="keyword">await</span> axios.get(url, {<span class="attr">params</span>: data})).data
        } <span class="keyword">else</span> <span class="keyword">if</span> (type === <span class="string">'post'</span>) {
            <span class="keyword">return</span> (<span class="keyword">await</span> axios.post(url, QS.stringify(data), {<span class="attr">headers</span>: {<span class="string">'content-type'</span>: <span class="string">'application/x-www-form-urlencoded;charset=utf-8'</span>}})).data
        } <span class="keyword">else</span> {
            <span class="keyword">return</span> res
        }
    } <span class="keyword">catch</span> (e) {
        <span class="keyword">return</span> res
    }
}</code></pre>
<p>api文件夹中调用 request.js 封装的 request函数</p>
<pre><code class="highlight js"><span class="comment">// 登录、注册、忘记密码模块</span>
<span class="keyword">import</span> { request } <span class="keyword">from</span> <span class="string">'../util/request.js'</span>

<span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params">data</span>) </span>{ <span class="comment">// 登录接口</span>
    <span class="keyword">return</span> request( <span class="string">'/api/login/collegeAdmin'</span>, data, <span class="string">'post'</span>)
}

<span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">register</span>(<span class="params">data</span>) </span>{ <span class="comment">// 注册接口</span>
  <span class="keyword">return</span> request(<span class="string">'/api/register'</span>, data, <span class="string">'post'</span>)
}

<span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">systemMessage</span>(<span class="params">data</span>) </span>{ <span class="comment">// 获取院管理员信息</span>
    <span class="keyword">return</span> request(<span class="string">'/api/account/msg'</span>, data, <span class="string">'get'</span>)
}

<span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">changePassword</span>(<span class="params">data</span>) </span>{ <span class="comment">// 获取院管理员信息</span>
    <span class="keyword">return</span> request(<span class="string">'/api/account/password/change'</span>, data, <span class="string">'post'</span>)
}
</code></pre>
<p>在action中的调用</p>
<pre><code class="highlight js"><span class="function"><span class="title">changePasswd</span>(<span class="params">{ commit },data</span>)</span>{
       <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> {
           changePassword(data).then(<span class="function"><span class="params">res</span> =&gt;</span> {
               <span class="keyword">if</span> (res.code === <span class="number">1</span>){
                   resolve(res.msg)
                   commit(<span class="string">'NULL'</span>)
               } <span class="keyword">else</span> {
                   reject(res.msg)
               }
           }).catch(<span class="function"><span class="params">error</span>=&gt;</span>{
               reject(error)
           })
       })</code></pre>

        </div>

        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/2020/07/01/javascript/Javascript%E5%B8%B8%E7%94%A8%E7%9A%8421%E4%B8%AA%E6%95%B0%E7%BB%84%E6%96%B9%E6%B3%95/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Javascript常用的21个数组方法</span>
                                <span class="post-nav-item">上一篇</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2020/05/05/vue/Vuex/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">vue学习笔记06-vuex</span>
                                <span class="post-nav-item">下一篇</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2020</span>&nbsp;-&nbsp;
            
            2021&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">大白小怪兽</a>
        </div>
        
        <div class="theme-info info-item">
            由 <a target="_blank" href="https://hexo.io">Hexo</a> 驱动&nbsp;|&nbsp;主题&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.1</a>
        </div>
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list show">
        <!--隐藏放大缩小字体和全屏模式-->
        <li class="tools-item tool-font-adjust-plus flex-center" style="display: none">
            <i class="fas fa-search-plus"></i>
        </li>
        <li class="tools-item tool-font-adjust-minus flex-center" style="display: none">
            <i class="fas fa-search-minus"></i>
        </li>
        <li class="tools-item tool-expand-width flex-center" style="display: none">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-text">vue学习笔记07-Promise和axios</span></a></li><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-text">Promise</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFPromise"><span class="nav-text">什么是Promise?</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E7%9A%84%E5%9B%9E%E8%B0%83%E5%9C%B0%E7%8B%B1"><span class="nav-text">网络请求的回调地狱</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Promise%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-text">Promise的使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E6%97%B6%E5%99%A8%E7%9A%84%E5%BC%82%E6%AD%A5%E4%BA%8B%E4%BB%B6"><span class="nav-text">定时器的异步事件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E6%97%B6%E5%99%A8%E5%BC%82%E6%AD%A5%E4%BA%8B%E4%BB%B6%E8%A7%A3%E6%9E%90"><span class="nav-text">定时器异步事件解析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Promise%E4%B8%89%E7%A7%8D%E7%8A%B6%E6%80%81"><span class="nav-text">Promise三种状态</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Promise%E9%93%BE%E5%BC%8F%E8%B0%83%E7%94%A8"><span class="nav-text">Promise链式调用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%93%BE%E5%BC%8F%E8%B0%83%E7%94%A8%E7%AE%80%E5%86%99"><span class="nav-text">链式调用简写</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-text">网络模块封装</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%89%E6%8B%A9%E4%BB%80%E4%B9%88%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%9D%97"><span class="nav-text">选择什么网络模块?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#jsonp"><span class="nav-text">jsonp</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#JSONP%E5%B0%81%E8%A3%85"><span class="nav-text">JSONP封装</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%80%89%E6%8B%A9axios"><span class="nav-text">为什么选择axios?</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#axiox%E8%AF%B7%E6%B1%82%E6%96%B9%E5%BC%8F"><span class="nav-text">axiox请求方式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%91%E9%80%81get%E8%AF%B7%E6%B1%82%E6%BC%94%E7%A4%BA"><span class="nav-text">发送get请求演示</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%91%E9%80%81%E5%B9%B6%E5%8F%91%E8%AF%B7%E6%B1%82"><span class="nav-text">发送并发请求</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E9%85%8D%E7%BD%AE%E9%80%89%E9%A1%B9"><span class="nav-text">常见的配置选项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#axios%E7%9A%84%E5%AE%9E%E4%BE%8B"><span class="nav-text">axios的实例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="nav-text">拦截器</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E4%B8%AD%E7%9A%84%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%9D%97%E4%BD%BF%E7%94%A8"><span class="nav-text">项目开发中的网络模块使用</span></a></li></ol></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.1/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.1/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.1/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.1/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.1/source/js/dark-light-toggle.js"></script>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.1/source/js/local-search.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.1/source/js/code-copy.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.1/source/js/lazyload.js"></script>


<div class="post-scripts pjax">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.1/source/js/left-side-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.1/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.1/source/js/toc.js"></script>
    
</div>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.1/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        const pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
